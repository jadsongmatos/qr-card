<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta
      name="description"
      content="Gerador de QR code NuBank. Adicione QR no seu cart達o NuBank"
    />
    <meta
      name="keywords"
      content="qrcode,nubank,nuconta,qr-code,gerador,adesivos,cart達o"
    />
    <meta name="robots" content="index, follow" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Jadson G. Matos" />
    <title>QR Card</title>

    <style>
      :root {
        --roxo: #8a05be;
      }

      @font-face {
        font-family: Graphik-Regular;
        src: url("https://cdn.nubank.com.br/fonts/Graphik/variants/Graphik-Regular.woff2");
      }

      html,
      body {
        margin: 0;
        font-family: Graphik-Regular, "Gotham SSm A", "Gotham SSm B",
          "Helvetica Neue", Helvetica, Arial, sans-serif !important;
      }

      .c-t {
        position: relative;
        text-align: center;
        left: 17.5vw;
        width: 65vw;
        border-radius: 2em;
      }

      .my-2 {
        margin-top: 2em;
        margin-bottom: 2em;
      }

      button {
        background-color: var(--roxo);
        border: 0;
        height: 3em;
        color: #fff;
        cursor: pointer;
      }

      input {
        padding-left: 2vw;
        padding-top: 1vh;
        padding-bottom: 1vh;
      }

      input::-webkit-outer-spin-button,
      input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
      }

      input:focus,
      select:focus,
      textarea:focus,
      button:focus {
        outline: none;
      }

      canvas {
        position: relative;
        left: 25vw;
        width: 50vw;
        border-radius: 1em;
        filter: drop-shadow(1vw 1vh 2vmax #555);
        margin-bottom: 2em;
      }

      footer {
        text-align: center;
        margin-top: 2em;
      }

      footer a {
        color: var(--roxo);
        text-decoration: none;
      }
    </style>
  </head>
  <body>
    <header>
      <h1 class="c-t">Gerador de QR code NuBank</h1>
      <h4 class="c-t">Adicione QR no seu cart達o NuBank</h4>
    </header>

    <main>
      <form id="qr-form" class="c-t">
        <input
          type="number"
          id="cpf"
          data-cpf
          class="my-2"
          placeholder="Seu CPF"
          required
        />
        <input
          type="text"
          id="name"
          class="my-2"
          data-name
          placeholder="Seu Nome"
          required
        />
      </form>

      <canvas id="qr-card" data-card width="1063" height="709"></canvas>

      <button type="button" id="download-btn" class="c-t b">
        Download
      </button>
    </main>

    <footer class="c-t">
      <a href="https://github.com/Slender1808" target="_blank" rel="noopener noreferrer">
        Created by Jadson G. Matos
      </a>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/qrious/dist/qrious.min.js"></script>
    <script>
      class QRCard {
        constructor(canvasSelector) {
          this.canvas = document.querySelector(canvasSelector);
          this.ctx = this.canvas.getContext("2d");
          this.qr = new QRious({
            element: document.createElement("canvas"),
            size: 177,
          });
          this.cpf = "";
          this.name = "";
        }

        render(cpf, name) {
          this.cpf = cpf || this.cpf;
          this.name = name || this.name;

          // Fundo do cart達o
          this.ctx.fillStyle = "#8a05be";
          this.ctx.fillRect(0, 0, 1063, 709);

          // Gerar QR Code
          this.qr.value = `nuapp://cpf/${this.cpf}`;
          this.ctx.drawImage(this.qr.element, 645, 64, 354, 354);

          // Nome
          this.ctx.fillStyle = "#fff";
          this.ctx.font = "64px Graphik-Regular";
          this.ctx.fillText(this.name, 64, 645);
        }

        download() {
          const link = document.createElement("a");
          link.download = `${this.name}-QrCard.png`;
          link.href = this.canvas.toDataURL("image/png");
          link.click();
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const qrCard = new QRCard("#qr-card");

        const form = document.getElementById("qr-form");
        const downloadBtn = document.getElementById("download-btn");

        form.addEventListener("input", () => {
          const cpf = form.querySelector("[data-cpf]").value;
          const name = form.querySelector("[data-name]").value;
          qrCard.render(cpf, name);
        });

        downloadBtn.addEventListener("click", () => qrCard.download());
      });
    </script>
  </body>
</html>
